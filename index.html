<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>QUANTARA — AI Betting Diary</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>

  <!-- Inline favicon -->
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='14' fill='%237c3aed'/%3E%3C/svg%3E">
</head>
<body>
  <div class="bg"><div class="bg-glow"></div><div class="bg-grid"></div></div>

  <header class="topbar">
    <div class="brand">
      <div class="logo-dot"></div>
      <div class="brand-text">
        <span class="brand-name">QUANTARA</span>
        <span class="brand-tag">AI Betting Diary</span>
      </div>
    </div>
    <div class="auth">
      <input id="email" type="email" placeholder="you@example.com" />
      <input id="password" type="password" placeholder="password" />
      <button id="signup"  type="button" class="btn btn-ghost">Sign up</button>
      <button id="signin"  type="button" class="btn btn-primary">Sign in</button>
      <button id="send-link" type="button" class="btn btn-ghost">Magic link</button>
      <button id="signout" style="display:none;" type="button" class="btn btn-ghost">Sign out</button>
    </div>
  </header>

  <main class="container">
    <div class="tabs">
      <button id="tab-btn-overview"  class="tab active">Overview</button>
      <button id="tab-btn-analytics" class="tab">Analytics</button>
      <button id="tab-btn-roi"       class="tab">ROI</button>
      <button id="tab-btn-calendar"  class="tab">Calendar</button>
    </div>

    <!-- OVERVIEW -->
    <div id="tab-overview">
      <section class="cards">
        <div class="card"><div class="card-label">Bankroll</div><div class="card-value" id="bankroll">€0</div></div>
        <div class="card"><div class="card-label">Total staked</div><div class="card-value" id="staked">€0</div></div>
        <div class="card"><div class="card-label">Win rate</div><div class="card-value" id="winrate">0%</div></div>
        <div class="card settings">
          <div class="card-label">Starting Bankroll (€)</div>
          <div class="settings-row">
            <input id="bankroll-start" type="number" step="1" placeholder="10000" />
            <button id="save-bankroll" class="btn btn-primary">Save</button>
          </div>
          <div class="muted small">Stored locally on your device.</div>
        </div>
      </section>

      <section class="charts">
        <div class="chart-card">
          <div class="chart-title">Bankroll over time</div>
          <canvas id="bankrollChart"></canvas>
        </div>
      </section>

      <section class="entry">
        <form id="add-form" class="add-form">
          <div class="form-title">Add bet</div>
          <input type="date" id="f-date" required />
          <input type="text" id="f-sport" placeholder="Football" required />
          <input type="text" id="f-league" placeholder="Serie A" />
          <input type="text" id="f-market" placeholder="Over 2.5" />
          <input type="text" id="f-selection" placeholder="Lecce-Genoa" />
          <input type="number" step="0.01" id="f-odds" placeholder="1.85" required />
          <input type="number" step="1" id="f-stake" placeholder="100" required />
          <select id="f-result">
            <option value="pending">pending</option>
            <option value="win">win</option>
            <option value="loss">loss</option>
            <option value="void">void</option>
          </select>
          <button type="submit" class="btn btn-primary">Save bet</button>
        </form>
      </section>

      <section class="ledger-section">
        <div class="section-title">Ledger</div>
        <div id="month-tabs" class="month-tabs"></div>
        <div class="table-wrap">
          <table id="ledger">
            <thead>
              <tr>
                <th>Date</th><th>Sport</th><th>League</th><th>Market</th>
                <th>Selection</th><th>Odds</th><th>Stake</th><th>Result</th><th>Profit</th><th class="right">Actions</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>
    </div>

    <!-- ANALYTICS -->
    <div id="tab-analytics" class="hidden">
      <section class="cards">
        <div class="card"><div class="card-label">Average odds (settled)</div><div class="card-value" id="avg-odds">0.00</div></div>
        <div class="card"><div class="card-label">Max drawdown</div><div class="card-value" id="max-dd">€0</div></div>
        <div class="card"><div class="card-label">Total bets</div><div class="card-value" id="bets-total">0</div></div>
        <div class="card"><div class="card-label">Pending</div><div class="card-value" id="bets-pending">0</div></div>
      </section>

      <!-- New analytics KPIs -->
      <section class="cards" style="margin-top:12px;">
        <div class="card"><div class="card-label">Profit factor</div><div class="card-value" id="pf">0.00</div></div>
        <div class="card"><div class="card-label">Avg stake</div><div class="card-value" id="avg-stake">€0</div></div>
        <div class="card"><div class="card-label">Median odds</div><div class="card-value" id="median-odds">0.00</div></div>
        <div class="card"><div class="card-label">Longest streak (W/L)</div><div class="card-value" id="streaks">0 / 0</div></div>
      </section>

      <section class="analytics-charts">
        <div class="chart-card span-2">
          <div class="chart-title">Stake by sport</div>
          <div class="donut-wrap-lg"><canvas id="analyticsStakeChart"></canvas></div>
        </div>
        <div class="chart-card">
          <div class="chart-title">Daily P&L</div>
          <canvas id="pnlBarChart"></canvas>
        </div>
        <div class="chart-card">
          <div class="chart-title">Odds distribution</div>
          <canvas id="oddsHistChart"></canvas>
        </div>
        <div class="chart-card">
          <div class="chart-title">Results breakdown</div>
          <canvas id="resultsPieChart"></canvas>
        </div>

        <!-- New charts -->
        <div class="chart-card">
          <div class="chart-title">P&L by month</div>
          <canvas id="pnlMonthChart"></canvas>
        </div>
        <div class="chart-card">
          <div class="chart-title">Win rate by sport</div>
          <canvas id="winRateBySportChart"></canvas>
        </div>
      </section>
    </div>

    <!-- ROI -->
    <div id="tab-roi" class="hidden">
      <section class="cards">
        <div class="card"><div class="card-label">Overall ROI</div><div class="card-value" id="roi-overall">0%</div></div>
        <div class="card"><div class="card-label">Settled Bets</div><div class="card-value" id="roi-settled">0</div></div>
        <div class="card"><div class="card-label">Profit (Settled)</div><div class="card-value" id="roi-profit">€0</div></div>
        <div class="card"><div class="card-label">Stake (Settled)</div><div class="card-value" id="roi-stake">€0</div></div>
      </section>

      <section class="ledger-section">
        <div class="section-title">ROI by sport</div>
        <div class="table-wrap">
          <table id="roi-table">
            <thead>
              <tr>
                <th>Sport</th>
                <th class="right">Bets</th>
                <th class="right">Stake</th>
                <th class="right">Profit</th>
                <th class="right">ROI</th>
              </tr>
            </thead>
            <tbody id="roi-tbody"></tbody>
          </table>
        </div>
      </section>
    </div>

    <!-- CALENDAR -->
    <div id="tab-calendar" class="hidden">
      <section class="calendar card">
        <div class="calendar-header">
          <button id="cal-prev" class="btn btn-ghost">‹</button>
          <div id="cal-title" class="calendar-title">Month YYYY</div>
          <button id="cal-next" class="btn btn-ghost">›</button>
        </div>
        <div class="calendar-grid" id="calendar-grid"></div>

        <div class="day-summary">
          <div class="day-summary-title">Day summary</div>
          <div class="day-summary-row">
            <div id="day-selected">—</div>
            <div id="day-pnl" class="pill">€0</div>
          </div>
        </div>

        <div class="table-wrap mini">
          <table>
            <thead>
              <tr>
                <th>Sport</th><th>Market</th><th>Selection</th>
                <th class="right">Odds</th><th class="right">Stake</th><th class="right">Result</th><th class="right">P/L</th>
              </tr>
            </thead>
            <tbody id="day-tbody"></tbody>
          </table>
        </div>

        <div class="calendar-legend">
          <span class="dot has-bet"></span> dates with bets show P/L in the box
          <button id="clear-filter" class="btn btn-ghost small">Clear</button>
        </div>
      </section>
    </div>
  </main>

  <!-- EDIT MODAL -->
  <div id="edit-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title">Edit bet</div>
        <button id="edit-close" class="btn btn-ghost">×</button>
      </div>
      <form id="edit-form" class="edit-form">
        <input type="hidden" id="e-id" />
        <input type="date" id="e-date" required />
        <input type="text" id="e-sport" placeholder="Football" required />
        <input type="text" id="e-league" placeholder="Serie A" />
        <input type="text" id="e-market" placeholder="Over 2.5" />
        <input type="text" id="e-selection" placeholder="Lecce-Genoa" />
        <input type="number" step="0.01" id="e-odds" placeholder="1.85" required />
        <input type="number" step="1" id="e-stake" placeholder="100" required />
        <select id="e-result">
          <option value="pending">pending</option>
          <option value="win">win</option>
          <option value="loss">loss</option>
          <option value="void">void</option>
        </select>
        <div class="edit-actions">
          <button type="button" id="edit-cancel" class="btn btn-ghost">Cancel</button>
          <button type="submit" class="btn btn-primary">Save changes</button>
        </div>
      </form>
    </div>
  </div>

  <script type="module" src="app.js?v=2"></script>
</body>
</html>
